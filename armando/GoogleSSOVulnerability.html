<?xml version="1.0" encoding="utf-8"?>
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
<title>Formal Analysis of SAML 2.0 Web
        Browser Single Sign-On: Breaking the SAML-based Single Sign-On
        for Google Apps
</title> 
</head>

<body>

<h2>Formal Analysis of SAML 2.0 Web Browser Single Sign-On: Breaking
the SAML-based Single Sign-On for Google Apps</h2>

<p>
<a href="http://www.ai-lab.it/armando">Alessandro Armando</a>
(University of Genova,
Italy), <a href="http://www.ai-lab.it/carbone">Roberto Carbone</a>
(University of Genova,
Italy), <a href="http://www.ai-lab.it/compagna">Luca Compagna</a> (SAP
Research, France), Jorge Cuellar (Siemens AG, Germany), Llanos Tobarra
Abad (Universidad de Castilla-La Mancha, Spain)</p>

<p><i>Abstract.</i> Single-Sign-On (SSO) protocols enable companies to
  establish a federated environment in which clients sign in the
  system once and yet are able to access to services offered by
  different companies.  The OASIS Security Assertion Markup Language
  (SAML) 2.0 Web Browser SSO Profile is the emerging standard in this
  context.  In this paper we provide formal models of the protocol
  corresponding to one of the most applied use case scenario (the
  SP-Initiated SSO with Redirect/POST Bindings) and of a variant of
  the protocol implemented by Google and currently in use by Google's
  customers (the SAML-based SSO for Google Applications).  We have
  mechanically analysed these formal models with SATMC, a
  state-of-the-art model checker for security protocols.  SATMC has
  revealed a severe security flaw in the protocol used by Google that
  allows a dishonest service provider to impersonate a user at another
  service provider.  We have also reproduced this attack in an actual
  deployment of the SAML-based SSO for Google Applications.  This
  security flaw of the SAML-based SSO for Google Applications was
  previously unknown.
</p>

Presented at the <a href="http://www.cs.utexas.edu/~shmat/FMSE08/">6th
ACM Workshop on Formal Methods in Security Engineering (FMSE
2008)</a>, October 27th, 2008, Hilton Alexandria Mark Center,
Virginia, USA.

<p>
<a href="fmse2008.bib">BibTeX</a> 
<a href="http://www.ai-lab.it/armando/pub/fmse9-armando.pdf">PDF</a>
</p>


<h3>Demo</h3>

<object width="425" height="344"><param name="movie" value="http://www.youtube.com/v/O202FBcQNuk?hl=en&fs=1"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="http://www.youtube.com/v/O202FBcQNuk?hl=en&fs=1" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="425" height="344"></embed></object>

<br/>
We are grateful to the following people who contributed to the
realization of the video: Roberto Basile (implementation) and Sophie
Galbraith (voice).

<h3>Further information</h3>
  <ul>
    <li>Vulnerability reports:
    <ul>
      <li>US-CERT <a href="http://www.kb.cert.org/vuls/id/612636">Vulnerability
	  Note VU#612636 "Google SAML Single Sign on
	  vulnerability"</a> (see
	  also <a href="http://www.kb.cert.org/vuls/id/MIMG-7FQGWU">Google
	  Information for Vulnerability Note VU#612636</a>)</li>
	  <li>NIST National Vulnerability Database
	    Vulnerability <a href="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2008-3891">CVE-2008-3891</a></li>
	  <li>Common Vulnerabilities and
	  Exposures: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-3891">CVE-2008-3891</a></li>
	</ul></li>

      <li>Acknowledgments by Google:
	<ul>
	  <li> <a href="http://www.google.com/corporate/security.html">Google
	      Corporate Information</a></li>
	  <li> <a href="http://groups.google.com/group/google-apps-apis/browse_thread/thread/8183040d7980a2e0">Message
	      posted on the "Google Apps APIs" group</a></li>
	</ul></li>
      <li>Google Apps: <a href="http://www.google.com/apps/">Web page of Google
	      Apps</a>, <a href="http://www.google.com/intl/en/press/pressrel/google_apps.html">Press release on Google Apps</a>
      </li>

      <li>On the Press:	  Il Secolo XIX (<a href="press/IlSecoloXIX-p1.pdf">page
	  1</a>, <a href="press/IlSecoloXIX-p8.pdf">page 8</a>), <a href="http://www.lastampa.it/cmstp/rubriche/girata.asp?ID_blog=30&ID_articolo=5070&tp=C">La Stampa</a>, <a href="http://punto-informatico.it/2397938/PI/News/cosi-scoprimmo-buco-google.aspx">Il Punto Informatico</a>, Heise online (<a href="http://www.h-online.com/news/Google-closes-hole-in-Single-Sign-On-for-Google-Apps--/111500">UK</a>, <a href="http://www.heise.de/netze/Google-schliesst-Luecke-in-Single-Sign-On-for-Google-Apps--/news/meldung/115711">D</a>), <a href="http://blogs.zdnet.com/security/?p=1880">ZDNet</a>, <a href="http://www.itworld.com/saas/54721/google-fixes-major-weakness-google-apps">IT World</a>, <a href="http://www.itmedia.co.jp/news/articles/0809/11/news023.html">IT Media</a>.
      </li>
      <li>Security Blogs:
	<ul>
	  <li><a href="http://www.identityblog.com/?p=1011">Kim Cameron's Identity Weblog</a></li>
	  <li><a href="http://ayo79.egloos.com/2541457">Korean Identity Weblog</a></li>
	  <li><a href="http://conorcahill.blogspot.com/2008/09/pseudonymity-would-help.html">Conor's
	  Web Log of Esoterica</a></li>
	  <li><a href="http://jacksonshaw.blogspot.com/2008/09/google-age-and-single-sign-on.html">Jackson's Identity Management &amp; Active Directory Reality Tour Travelblog</a></li>
	  <li><a href="http://xmlnetworking.blogspot.com/2008/09/google-saml-vulnerability.html">XML Networking</a></li>
	</ul>
      </li>
    </ul>
  
  <hr/>
    This work is partially supported by the FP7-ICT-2007-1 Project no.
    216471, <a href="http://www.avantssar.eu">AVANTSSAR: Automated
    Validation of Trust and Security of Service-oriented
    Architectures</a>

<hr/>
<a href="http://www.ai-lab.it/armando/">Alessandro Armando's Home Page</a>
</body>
</html>
